name: Control Railway Server

on:
  schedule:
    - cron: '0 14 * * *' # Ejecutar a las 8:00 AM UTC-6 (2:00 PM UTC)
    - cron: '0 22 * * *' # Ejecutar a las 4:00 PM UTC-6 (10:00 PM UTC)
  workflow_dispatch: # Permite la ejecuci√≥n manual del workflow

jobs:
  control-server:
    runs-on: ubuntu-latest
    steps:
      - name: Encender o Apagar Servidor
        run: |
          # Cambia esto por tu API Key y el ID del proyecto
          RAILWAY_API_KEY="feef0e65-2959-4585-8c8c-0966b502e8fc"  # Tu API Key
          PROJECT_ID="e2b9041a-af2d-4349-9f0b-643a5b56451d"  # Tu Project ID

          # Hora actual en formato de 24 horas
          HOUR=$(date +'%H')

          if [ "$HOUR" -eq 14 ]; then
            echo "Encendiendo el servidor..."
            curl -n -X PATCH "https://railway.app/api/v1/project/$PROJECT_ID" \
            -H "Authorization: Bearer $RAILWAY_API_KEY" \
            -d '{"enabled": true}'
          elif [ "$HOUR" -eq 22 ]; then
            echo "Apagando el servidor..."
            curl -n -X PATCH "https://railway.app/api/v1/project/$PROJECT_ID" \
            -H "Authorization: Bearer $RAILWAY_API_KEY" \
            -d '{"enabled": false}'
          else
            echo "No es hora de encender o apagar el servidor."
          fi
